(function(){"use strict";var e={5455:function(e,t,a){a(4114);var s=a(3751),o=a(1250),n=a(414),l=a.n(n),i=a(6278),r=a(2543),d=a(6373);const c=(0,d.Ay)("localhost"===window.location.hostname?"http://localhost:3000":"https://sn-handover-app.azurewebsites.net",{transports:["websocket"],withCredentials:!0});var u=c;let m=null,p=null;const h=(0,i.y$)({state:{pages:[],shifts:[],currentPage:{lastEditedBy:"",version:null},toasts:[],toastId:0,searchResults:[],currentShift:null,incidents:[],usersOnPage:[],isPageLocked:!1,lockedByUser:null,lockedPageId:null,clients:[],slaQuotas:{},lastUpdateSource:"server"},mutations:{setPages(e,t){e.pages=t},setCurrentPage(e,t){e.currentPage={...t,lastEditedBy:t.lastEditedBy||"Unknown",version:t.version||(new Date).toISOString()}},updatePageVersion(e,t){e.currentPage.version=t},addPage(e,t){e.pages.push(t)},setShifts(e,t){e.shifts=t},setCurrentShift(e,t){e.currentShift=t},updatePage(e,t){const a=e.pages.findIndex((e=>e.id===t.id));-1!==a&&e.pages.splice(a,1,t)},addShift(e,t){e.shifts.push(t)},updateShift(e,t){const a=e.shifts.findIndex((e=>e.id===t.id));-1!==a&&e.shifts.splice(a,1,t)},setClients(e,t){e.clients=t,e.clientNameToIdMap=t.reduce(((e,t)=>(e[t.client]=t.id,e)),{})},setSLAQuotas(e,{clientId:t,quotas:a}){e.slaQuotas[t]=a},updateSLAQuotas(e,{clientId:t,quotas:a}){e.slaQuotas[t]=a},addToast(e,t){const a=e.toastId++;t.id=a,e.toasts.push(t),setTimeout((()=>{e.toasts=e.toasts.filter((e=>e.id!==a))}),3e3)},setUsersOnPage(e,t){JSON.stringify(e.usersOnPage)!==JSON.stringify(t)&&(console.log("Setting users on page:",t),e.usersOnPage=t)},setEditLock(e,{isLocked:t,userName:a,pageId:s,pageTitle:o}){e.isPageLocked=t,e.lockedByUser=t?a:null,e.lockedPageId=t?s:null,e.lockedPageTitle=t?o:null},setSearchResults(e,t){e.searchResults=t},setIncidents(e,t){e.incidents=t},setLastUpdateSource(e,t){e.lastUpdateSource=t},deletePage(e,t){e.pages=e.pages.filter((e=>e.id!==t)),e.currentPage&&e.currentPage.id===t&&(e.currentPage=null)}},actions:{async deletePage({commit:e},{pageId:t}){try{const a=await fetch(`/api/records/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok){const e=await a.text();throw new Error(`Failed to delete page: ${e}`)}e("deletePage",t)}catch(a){throw console.error("Error deleting the page:",a),a}},debouncedLockEditMode:(0,r.debounce)((async function({state:e},{pageId:t,userName:a,pageTitle:s}){console.log(t,a,s),e.isPageLocked&&e.lockedPageId===t||u.emit("lockEditMode",{pageId:t,userName:a,pageTitle:s})}),200),debouncedUnlockEditMode:(0,r.debounce)((async function({commit:e,state:t},{pageId:a,userName:s,pageTitle:o}){t.isPageLocked&&t.lockedPageId===a&&(u.emit("unlockEditMode",{pageId:a,userName:s,pageTitle:o}),e("setEditLock",{isLocked:!1,userName:null,pageId:null,pageTitle:null}))}),200),async fetchPages({commit:e,dispatch:t}){try{console.log(localStorage.getItem("user"));const a=await fetch("/api/records",{credentials:"include"});if(!a.ok)throw new Error("Network response was not ok");const s=await a.json();e("setPages",s),s.length>0&&t("fetchPageDetails",s[0].id)}catch(a){console.error("Error fetching pages:",a),e("addToast",{message:`Fetch pages error: ${a.message}`,type:"danger"})}},debouncedPerformSearch:(0,r.debounce)((async function({commit:e},t){try{const a=await fetch(`/api/search?q=${encodeURIComponent(t)}`);if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);if(""===t)return;const s=await a.json();e("setSearchResults",s)}catch(a){console.error("Search error: Record not found"),e("addToast",{message:"Search error: Record not found",type:"danger"})}}),200),async fetchPageDetails({commit:e},t){p&&u.emit("leavePage",{pageId:p});try{const s=await fetch(`/api/records/${t}`,{credentials:"include"});if(!s.ok)throw new Error(`HTTP status: ${s.status}`);const o=await s.text();try{const t=JSON.parse(o);console.log("Received response:",t),e("setCurrentPage",t),u.emit("viewPage",{pageId:t.id}),p=t.id,m&&(console.log("Removing previous usersOnPage listener"),u.off("usersOnPage",m)),m=t=>{console.log("Users on page event received:",t),e("setUsersOnPage",t)},u.on("usersOnPage",m)}catch(a){console.error("Error parsing JSON:",a),e("addToast",{message:`JSON parse error: ${a.message}`,type:"danger"})}}catch(s){console.error("Network or response error:",s),e("addToast",{message:`Network error: ${s.message}`,type:"danger"})}},async fetchLatestPage({commit:e}){try{const e=await fetch("/api/latest-page",{credentials:"include"});if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();return t}catch(t){console.error("Error fetching latest page:",t),e("addToast",{message:`Fetch latest page error: ${t.message}`,type:"danger"})}},debouncedUpdatePageDetails:(0,r.debounce)((async function({commit:e},{page:t,source:a}){try{const s=localStorage.getItem("user")||"Unknown",o=await fetch(`/api/records/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,source:a,lastEditedBy:s}),credentials:"include"});if(!o.ok)throw new Error("Network response was not ok");const n=await o.json();e("setCurrentPage",n),e("updatePage",n),e("updatePageVersion",n.version)}catch(s){console.error("Error updating page details:",s),e("addToast",{message:`Update page error: ${s.message}`,type:"danger"})}}),200),debouncedCopyHandover:(0,r.debounce)((async function({commit:e}){try{const t=await fetch("/api/copy-handover",{method:"POST",credentials:"include"}),a=await t.json();if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);e("setCurrentPage",a)}catch(t){console.error("Error creating handover from template:",t),e("addToast",{message:`Copy handover error: ${t.message}`,type:"danger"})}}),200),debouncedCreateHandoverTemplate:(0,r.debounce)((async function({commit:e}){try{const t=await fetch("/api/copy-template",{method:"POST",credentials:"include"}),a=await t.json();e("setCurrentPage",a)}catch(t){console.error("Error creating handover from template:",t),e("addToast",{message:`Create template error: ${t.message}`,type:"danger"})}}),200),async fetchShifts({commit:e}){try{const t=await fetch("/api/shifts",{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const a=await t.json();e("setShifts",a)}catch(t){console.error("Error fetching shifts:",t),e("addToast",{message:`Fetch shifts error: ${t.message}`,type:"danger"})}},async fetchShiftDetails({commit:e},t){try{const a=await fetch(`/api/shifts/${t}`,{credentials:"include"});if(!a.ok)throw new Error(`HTTP status: ${a.status}`);const s=await a.json();return e("setCurrentShift",s),s}catch(a){console.error("Error fetching shift details:",a),e("addToast",{message:`Fetch shift details error: ${a.message}`,type:"danger"})}},async createShift({commit:e},t){try{const a=await fetch("/api/shifts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok)throw new Error("Network response was not ok");const s=await a.json();e("addShift",s),e("setCurrentShift",s),e("addToast",{message:"Shift created successfully.",type:"success"})}catch(a){console.error("Error creating shift:",a),e("addToast",{message:`Create shift error: ${a.message}`,type:"danger"})}},async updateShiftDetails({commit:e},t){try{const a=await fetch(`/api/shifts/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok)throw new Error("Network response was not ok");const s=await a.json();e("setCurrentShift",s),e("updateShift",s),e("addToast",{message:"Shift details updated successfully.",type:"success"})}catch(a){console.error("Error updating shift details:",a),e("addToast",{message:`Update shift error: ${a.message}`,type:"danger"})}},async fetchClients({commit:e}){try{const t=await fetch("/api/clients",{credentials:"include"}),a=await t.json();e("setClients",a)}catch(t){console.error("Error fetching clients:",t)}},async fetchClientSLAQuotas({commit:e},t){try{const a=await fetch(`/api/clients/${t}`,{credentials:"include"}),s=await a.text();if(console.log("Raw response:",s),!a.ok)throw new Error("Failed to fetch client SLA quotas");if(!s)throw new Error("No data returned from the server");const o=JSON.parse(s);return e("setClientSLAQuotas",o.slaQuotas),o}catch(a){console.error("Error fetching client SLA quotas:",a)}},async updateClientSLAQuotas({commit:e},{clientId:t,slaQuotas:a}){try{const s=await fetch(`/api/clients/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slaQuotas:a}),credentials:"include"});if(!s.ok)throw new Error("Failed to update client SLA quotas");const o=await s.json();console.log("SLA quotas updated successfully:",o),e("updateClientSLAQuotas",o),e("addToast",{message:"Client SLA quotas updated successfully.",type:"success"})}catch(s){console.error("Error updating client SLA quotas:",s)}},async createNewClient({commit:e},t){try{const a=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(409===a.status)return void e("addToast",{message:"Client with this name already exists.",type:"danger"});if(!a.ok)throw new Error("Failed to add new client");const s=await a.json();return e("addToast",{message:"New client added successfully",type:"success"}),s}catch(a){throw console.error("Error adding new client:",a),e("addToast",{message:"Failed to add new client",type:"error"}),a}}}});u.on("connect",(()=>{console.log("Socket.io connected")})),u.on("disconnect",(()=>{console.log("Socket.io disconnected"),u.connect()})),u.on("usersOnPage",(e=>{h.commit("setUsersOnPage",e)})),u.on("pageCreated",(e=>{console.log("Page created event received:",e);const t=h.state.pages.some((t=>t.id===e.id));t||(h.commit("addPage",e),h.commit("addToast",{message:"Handover copied successfully.",type:"success"}))})),u.on("pageUpdated",(e=>{console.log("Page updated event received:",e),"client"!==h.state.lastUpdateSource&&(h.commit("updatePage",e),h.state.currentPage&&h.state.currentPage.id===e.id&&h.commit("setCurrentPage",e)),h.commit("addToast",{message:`Page ${e.title} updated`,type:"success"}),h.commit("setLastUpdateSource","server")})),u.removeAllListeners("pageDeleted"),u.on("pageDeleted",(e=>{console.log("Page deleted event received:",e),e.title&&"undefined"!==e.title&&h.commit("addToast",{message:`Page "${e.title}" deleted successfully.`,type:"danger"}),h.commit("deletePage",e.id)})),u.on("lockEditMode",(e=>{console.log("Lock edit mode event received:",e),h.commit("setEditLock",{isLocked:!0,userName:e.userName,pageId:e.pageId,pageTitle:e.pageTitle}),h.commit("addToast",{message:`${e.userName} is now editing ${e.pageTitle||"this page"}`,type:"info"})})),u.on("unlockEditMode",(({pageId:e,pageTitle:t})=>{console.log(e),h.commit("setEditLock",{isLocked:!1,userName:null,pageId:null,pageTitle:null}),h.commit("addToast",{message:`Page ${t} is now unlocked.`,type:"info"})})),u.on("pageAlreadyLocked",(({pageId:e,userName:t,pageTitle:a})=>{console.log(e),h.commit("addToast",{message:`Page ${a} is already being edited by ${t}.`,type:"error"})}));var g=h,b=a(641),k=a(33);const v={id:"app"},f={class:"toast-container position-fixed bottom-0 end-0 p-3"},L=["data-id"],y={class:"d-flex"},P={class:"toast-body"},w=(0,b.Lk)("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto","data-bs-dismiss":"toast","aria-label":"Close"},null,-1);function C(e,t,a,s,o,n){const l=(0,b.g2)("router-view");return(0,b.uX)(),(0,b.CE)("div",v,[(0,b.bF)(l),(0,b.Lk)("div",f,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.toasts,(e=>((0,b.uX)(),(0,b.CE)("div",{key:e.id,"data-id":e.id,class:(0,k.C4)(["toast",`bg-${e.type}`])},[(0,b.Lk)("div",y,[(0,b.Lk)("div",P,(0,k.v_)(e.message),1),w])],10,L)))),128))])])}var S={name:"App",data(){return{isAuthenticated:!1}},created(){this.checkAuthentication()},computed:{...(0,i.aH)(["toasts"])},watch:{toasts:{immediate:!0,deep:!0,handler(e){e.forEach((e=>{this.initializeToast(e)}))}}},methods:{checkAuthentication(){this.isAuthenticated=!!localStorage.getItem("userAuthenticated"),this.isAuthenticated||this.$router.push("/login")},initializeToast(e){this.$nextTick((()=>{const t=document.querySelector(`.toast[data-id="${e.id}"]`);if(t){const e=new(l().Toast)(t);e.show()}else console.error("Toast element not found",e)}))}}},E=a(6262);const I=(0,E.A)(S,[["render",C]]);var N=I,q=a(5220);const T={class:"login-container"};function D(e,t,a,s,o,n){return(0,b.uX)(),(0,b.CE)("div",T,[(0,b.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.login&&n.login(...e))},"Log in with Azure AD")])}var A={methods:{login(){window.location.href="/auth/signin"}}};const U=(0,E.A)(A,[["render",D],["__scopeId","data-v-5d7b2e5f"]]);var M=U;const _={id:"home-container"},$={class:"main-container"},x={class:"sidebar"},R={class:"content"};function Q(e,t,a,s,o,n){const l=(0,b.g2)("NavBarComponent"),i=(0,b.g2)("SideBarComponent"),r=(0,b.g2)("shiftComp");return(0,b.uX)(),(0,b.CE)("div",_,[(0,b.bF)(l),(0,b.Lk)("div",$,[(0,b.Lk)("aside",x,[(0,b.bF)(i)]),(0,b.Lk)("div",R,[(0,b.bF)(r)])])])}const O=e=>((0,b.Qi)("data-v-0cc27aec"),e=e(),(0,b.jt)(),e),X={class:"navbar navbar-expand-lg bg-light"},V={class:"container-fluid"},F=O((()=>(0,b.Lk)("a",{class:"navbar-brand",href:"/"},"Handover pages",-1))),j=O((()=>(0,b.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,b.Lk)("span",{class:"navbar-toggler-icon"})],-1))),J={class:"collapse navbar-collapse justify-content-between",id:"navbarSupportedContent"},H={class:"navbar-nav"},B={class:"nav-item"},K={key:0,class:"search-results"},z=["onClick"],W={class:"d-flex align-items-center"},Y=O((()=>(0,b.Lk)("i",{class:"bi bi-gear"},null,-1))),G=[Y],Z={class:"navbar-nav"},ee={class:"nav-item dropdown"},te={class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdownMenuLink",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},ae=O((()=>(0,b.Lk)("ul",{class:"dropdown-menu dropdown-menu-end","aria-labelledby":"navbarDropdownMenuLink"},[(0,b.Lk)("li",null,[(0,b.Lk)("a",{class:"dropdown-item",href:"/auth/signout"},"Sign out")])],-1)));function se(e,t,a,o,n,l){const i=(0,b.g2)("SLAProgressModal"),r=(0,b.g2)("settingsModal");return(0,b.uX)(),(0,b.CE)("nav",X,[(0,b.Lk)("div",V,[F,j,(0,b.Lk)("div",J,[(0,b.Lk)("ul",H,[(0,b.Lk)("li",B,[(0,b.Lk)("a",{class:"nav-link active","aria-current":"page",href:"#",onClick:t[0]||(t[0]=(...e)=>l.openSlaModal&&l.openSlaModal(...e))},"SLA Progress")])]),(0,b.Lk)("form",{class:"d-flex justify-content-center flex-grow-1 mx-3",role:"search",onSubmit:t[3]||(t[3]=(0,s.D$)(((...e)=>l.performSearch&&l.performSearch(...e)),["prevent"]))},[(0,b.bo)((0,b.Lk)("input",{class:"form-control w-100","onUpdate:modelValue":t[1]||(t[1]=e=>n.searchTerm=e),type:"search",placeholder:"Search","aria-label":"Search",onKeyup:t[2]||(t[2]=(0,s.jR)(((...e)=>l.performSearch&&l.performSearch(...e)),["enter"]))},null,544),[[s.Jo,n.searchTerm]]),l.searchResults.length?((0,b.uX)(),(0,b.CE)("div",K,[(0,b.Lk)("ul",null,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(l.searchResults,(e=>((0,b.uX)(),(0,b.CE)("li",{key:e.id},[(0,b.Lk)("a",{href:"#",onClick:(0,s.D$)((t=>l.loadPage(e.id)),["prevent"])},(0,k.v_)(e.title),9,z)])))),128))])])):(0,b.Q3)("",!0)],32),(0,b.Lk)("div",W,[(0,b.Lk)("button",{class:"btn btn-link text-decoration-none",id:"settings-btn",href:"#",onClick:t[4]||(t[4]=(...e)=>l.openSettingsModal&&l.openSettingsModal(...e))},G),(0,b.Lk)("ul",Z,[(0,b.Lk)("li",ee,[(0,b.Lk)("a",te,(0,k.v_)(n.userProfile.displayName),1),ae])])])]),(0,b.bF)(i,{ref:"slaModal"},null,512),(0,b.bF)(r,{ref:"settingsModal"},null,512)])])}const oe=e=>((0,b.Qi)("data-v-b121495c"),e=e(),(0,b.jt)(),e),ne={class:"modal fade",id:"slaProgressModal",tabindex:"-1","aria-labelledby":"slaProgressModalLabel","aria-hidden":"true"},le={class:"modal-dialog modal-xl"},ie={class:"modal-content"},re=oe((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"slaProgressModalLabel"},"SLA Progress"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),de={class:"modal-body"},ce={class:"table"},ue=oe((()=>(0,b.Lk)("thead",null,[(0,b.Lk)("tr",null,[(0,b.Lk)("th",null,"Incident Number"),(0,b.Lk)("th",null,"Status"),(0,b.Lk)("th",null,"Date Opened"),(0,b.Lk)("th",null,"Priority"),(0,b.Lk)("th",null,"SLA Progress")])],-1))),me={class:"progress"},pe=["aria-valuenow"];function he(e,t,a,s,o,n){return(0,b.uX)(),(0,b.CE)("div",null,[(0,b.Lk)("div",ne,[(0,b.Lk)("div",le,[(0,b.Lk)("div",ie,[re,(0,b.Lk)("div",de,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(o.groupedIncidents,((e,t)=>((0,b.uX)(),(0,b.CE)("div",{key:t},[(0,b.Lk)("h5",null,(0,k.v_)(t),1),(0,b.Lk)("table",ce,[ue,(0,b.Lk)("tbody",null,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e,(e=>((0,b.uX)(),(0,b.CE)("tr",{key:e.incNumber},[(0,b.Lk)("td",null,(0,k.v_)(e.incNumber),1),(0,b.Lk)("td",null,(0,k.v_)(e.status),1),(0,b.Lk)("td",null,(0,k.v_)(n.formatDate(e.dateOpened)),1),(0,b.Lk)("td",null,(0,k.v_)(e.priority),1),(0,b.Lk)("td",null,[(0,b.Lk)("div",me,[(0,b.Lk)("div",{class:(0,k.C4)(["progress-bar",n.slaProgressClass(e,t)]),style:(0,k.Tr)({width:n.calculateSLAProgress(e,t)+"%"}),role:"progressbar","aria-valuenow":n.calculateSLAProgress(e,t),"aria-valuemin":"0","aria-valuemax":"100"},(0,k.v_)(n.calculateSLAProgress(e,t))+"% ",15,pe)])])])))),128))])])])))),128))])])])])])}var ge={name:"SLAProgressModal",data(){return{groupedIncidents:{},slaQuotasByClient:{}}},methods:{...(0,i.i0)(["fetchLatestPage","fetchClientSLAQuotas"]),async openSlaModal(){const e=await this.fetchLatestPage(),t={},a=[];e.records.incidents.forEach((e=>{"Resolved"!==e.status&&(t[e.client]||(t[e.client]=[],a.push(this.loadClientSLAQuotas(e.client))),t[e.client].push(e))})),await Promise.all(a),this.groupedIncidents=t;const s=new(l().Modal)(document.getElementById("slaProgressModal"));s.show()},async loadClientSLAQuotas(e){const t=this.$store.state.clientNameToIdMap[e];if(t&&!this.slaQuotasByClient[e]){const a=await this.fetchClientSLAQuotas(t);a&&a.slaQuotas?this.slaQuotasByClient[e]=a.slaQuotas:this.slaQuotasByClient[e]={quota_P1:180,quota_P2:480,quota_P3:1440,quota_P4:2400}}},formatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString(void 0,t)},calculateSLAProgress(e,t){const a=this.slaQuotasByClient[t]||{},s={"P1 - Critical":a.quota_P1,"P2 - high":a.quota_P2,"P3 - moderate":a.quota_P3,"P4 - Low":a.quota_P4},o=s[e.priority]||0,n=new Date(e.dateOpened),l=new Date,i=(l-n)/6e4,r=Math.min(i/o*100,100);return r.toFixed(2)},slaProgressClass(e,t){const a=this.calculateSLAProgress(e,t);return{"bg-success":a<=75,"bg-warning":a>75&&a<=90,"bg-danger":a>90}}}};const be=(0,E.A)(ge,[["render",he],["__scopeId","data-v-b121495c"]]);var ke=be;const ve=e=>((0,b.Qi)("data-v-2d80af12"),e=e(),(0,b.jt)(),e),fe={class:"modal fade",id:"settingsModal",tabindex:"-1","aria-labelledby":"settingsModalLabel","aria-hidden":"true"},Le={class:"modal-dialog"},ye={class:"modal-content"},Pe=ve((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"settingsModalLabel"},"Settings"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),we={class:"modal-body"},Ce={class:"edit-sla-quotas"},Se=ve((()=>(0,b.Lk)("h5",null,"Edit SLA Quotas",-1))),Ee=ve((()=>(0,b.Lk)("hr",null,null,-1))),Ie=ve((()=>(0,b.Lk)("label",{for:"client-select",class:"form-label"},"Select Client",-1))),Ne=["value"],qe={key:0},Te={class:"mt-3"},De=ve((()=>(0,b.Lk)("label",{for:"quotaP1",class:"form-label"},"P1 Quota (Critical)",-1))),Ae=["disabled"],Ue={class:"mt-3"},Me=ve((()=>(0,b.Lk)("label",{for:"quotaP2",class:"form-label"},"P2 Quota (High)",-1))),_e=["disabled"],$e={class:"mt-3"},xe=ve((()=>(0,b.Lk)("label",{for:"quotaP3",class:"form-label"},"P3 Quota (Moderate)",-1))),Re=["disabled"],Qe={class:"mt-3"},Oe=ve((()=>(0,b.Lk)("label",{for:"quotaP4",class:"form-label"},"P4 Quota (Low)",-1))),Xe=["disabled"],Ve=ve((()=>(0,b.Lk)("button",{type:"submit",class:"btn btn-primary mt-3"},"Save SLA changes",-1))),Fe=ve((()=>(0,b.Lk)("hr",null,null,-1))),je={key:1},Je=ve((()=>(0,b.Lk)("h5",null,"Add New Client",-1))),He=ve((()=>(0,b.Lk)("hr",null,null,-1))),Be=ve((()=>(0,b.Lk)("label",{for:"newClientName",class:"form-label"},"Client Name",-1))),Ke={class:"mt-3"},ze=ve((()=>(0,b.Lk)("label",{for:"newQuotaP1",class:"form-label"},"P1 Quota (Critical)",-1))),We={class:"mt-3"},Ye=ve((()=>(0,b.Lk)("label",{for:"newQuotaP2",class:"form-label"},"P2 Quota (High)",-1))),Ge={class:"mt-3"},Ze=ve((()=>(0,b.Lk)("label",{for:"newQuotaP3",class:"form-label"},"P3 Quota (Moderate)",-1))),et={class:"mt-3"},tt=ve((()=>(0,b.Lk)("label",{for:"newQuotaP4",class:"form-label"},"P4 Quota (Low)",-1))),at=ve((()=>(0,b.Lk)("button",{type:"submit",class:"btn btn-primary mt-3"},"Save New Client",-1))),st=ve((()=>(0,b.Lk)("hr",null,null,-1))),ot={class:"edit-shift"},nt=ve((()=>(0,b.Lk)("h5",null,"Edit Shift details",-1))),lt=ve((()=>(0,b.Lk)("hr",null,null,-1))),it=ve((()=>(0,b.Lk)("label",{for:"shift-select",class:"form-label"},"Select Shift",-1))),rt=["value"],dt={key:0},ct=["for"],ut=["onUpdate:modelValue","id","disabled"],mt=ve((()=>(0,b.Lk)("button",{type:"submit",class:"btn btn-primary mt-3"},"Save Shift Changes",-1))),pt={class:"function-control"},ht=ve((()=>(0,b.Lk)("h5",null,"Azure Function Control",-1))),gt=ve((()=>(0,b.Lk)("hr",null,null,-1))),bt={class:"mt-2"},kt=ve((()=>(0,b.Lk)("hr",null,null,-1))),vt=ve((()=>(0,b.Lk)("hr",null,null,-1))),ft=ve((()=>(0,b.Lk)("div",{class:"modal-footer"},[(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1)));function Lt(e,t,a,o,n,l){return(0,b.uX)(),(0,b.CE)("div",fe,[(0,b.Lk)("div",Le,[(0,b.Lk)("div",ye,[Pe,(0,b.Lk)("div",we,[(0,b.Lk)("div",Ce,[Se,Ee,Ie,(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedClientId=e),onChange:t[1]||(t[1]=(...e)=>l.fetchSLAQuotas&&l.fetchSLAQuotas(...e)),id:"client-select",class:"form-select"},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.clients,(e=>((0,b.uX)(),(0,b.CE)("option",{value:e.id,key:e.id},(0,k.v_)(e.client),9,Ne)))),128))],544),[[s.u1,n.selectedClientId]]),n.slaQuotas?((0,b.uX)(),(0,b.CE)("div",qe,[(0,b.Lk)("form",{onSubmit:t[6]||(t[6]=(0,s.D$)(((...e)=>l.saveSlaChanges&&l.saveSlaChanges(...e)),["prevent"]))},[(0,b.Lk)("div",Te,[De,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.slaQuotas.quota_P1=e),type:"number",class:"form-control",id:"quotaP1",disabled:l.isEngineer,required:""},null,8,Ae),[[s.Jo,n.slaQuotas.quota_P1]])]),(0,b.Lk)("div",Ue,[Me,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.slaQuotas.quota_P2=e),type:"number",class:"form-control",id:"quotaP2",disabled:l.isEngineer,required:""},null,8,_e),[[s.Jo,n.slaQuotas.quota_P2]])]),(0,b.Lk)("div",$e,[xe,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.slaQuotas.quota_P3=e),type:"number",class:"form-control",id:"quotaP3",disabled:l.isEngineer,required:""},null,8,Re),[[s.Jo,n.slaQuotas.quota_P3]])]),(0,b.Lk)("div",Qe,[Oe,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>n.slaQuotas.quota_P4=e),type:"number",class:"form-control",id:"quotaP4",disabled:l.isEngineer,required:""},null,8,Xe),[[s.Jo,n.slaQuotas.quota_P4]])]),Ve],32)])):(0,b.Q3)("",!0),Fe,l.isEngineer?(0,b.Q3)("",!0):((0,b.uX)(),(0,b.CE)("div",je,[Je,He,(0,b.Lk)("form",{onSubmit:t[12]||(t[12]=(0,s.D$)(((...e)=>l.saveNewClient&&l.saveNewClient(...e)),["prevent"]))},[Be,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>n.newClientName=e),type:"text",class:"form-control",id:"newClientName",placeholder:"Enter new client name",required:""},null,512),[[s.Jo,n.newClientName]]),(0,b.Lk)("div",Ke,[ze,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>n.newClientQuotas.quota_P1=e),type:"number",class:"form-control",id:"newQuotaP1",required:""},null,512),[[s.Jo,n.newClientQuotas.quota_P1]])]),(0,b.Lk)("div",We,[Ye,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>n.newClientQuotas.quota_P2=e),type:"number",class:"form-control",id:"newQuotaP2",required:""},null,512),[[s.Jo,n.newClientQuotas.quota_P2]])]),(0,b.Lk)("div",Ge,[Ze,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>n.newClientQuotas.quota_P3=e),type:"number",class:"form-control",id:"newQuotaP3",required:""},null,512),[[s.Jo,n.newClientQuotas.quota_P3]])]),(0,b.Lk)("div",et,[tt,(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>n.newClientQuotas.quota_P4=e),type:"number",class:"form-control",id:"newQuotaP4",required:""},null,512),[[s.Jo,n.newClientQuotas.quota_P4]])]),at],32)])),st]),(0,b.Lk)("div",ot,[nt,lt,it,(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>n.selectedShiftId=e),onChange:t[14]||(t[14]=(...e)=>l.fetchShiftDetails&&l.fetchShiftDetails(...e)),id:"shift-select",class:"form-select"},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.shifts,(e=>((0,b.uX)(),(0,b.CE)("option",{value:e.id,key:e.id},(0,k.v_)(e.title),9,rt)))),128))],544),[[s.u1,n.selectedShiftId]]),n.currentShift&&n.currentShift.engineers.length?((0,b.uX)(),(0,b.CE)("div",dt,[(0,b.Lk)("form",{onSubmit:t[15]||(t[15]=(0,s.D$)(((...e)=>l.saveShiftChanges&&l.saveShiftChanges(...e)),["prevent"]))},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(n.currentShift.engineers.slice(0,4),((e,t)=>((0,b.uX)(),(0,b.CE)("div",{key:t,class:"mt-3"},[(0,b.Lk)("label",{for:"engineer-"+t,class:"form-label"},"Engineer "+(0,k.v_)(t+1)+" name",9,ct),(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t=>e.name=t,type:"text",class:"form-control",id:"engineer-"+t,placeholder:"Enter engineer name",disabled:l.isEngineer},null,8,ut),[[s.Jo,e.name]])])))),128)),mt],32)])):(0,b.Q3)("",!0)]),(0,b.Lk)("div",pt,[ht,gt,(0,b.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>l.toggleFunctionState&&l.toggleFunctionState(...e)),class:(0,k.C4)(n.functionDisabled?"btn btn-danger":"btn btn-success")},(0,k.v_)(n.functionDisabled?"Enable Function":"Disable Function"),3),(0,b.Lk)("p",bt,[(0,b.eW)(" Status: "),(0,b.Lk)("strong",null,(0,k.v_)(n.functionDisabled?"Disabled":"Enabled"),1)])]),kt]),vt,ft])])])}var yt={data(){return{selectedClientId:null,selectedShiftId:null,currentShift:{title:"",engineers:[{name:""},{name:""},{name:""},{name:""}]},slaQuotas:{quota_P1:"",quota_P2:"",quota_P3:"",quota_P4:""},newClientName:"",newClientQuotas:{quota_P1:"",quota_P2:"",quota_P3:"",quota_P4:""},userProfile:{role:localStorage.getItem("roles")},functionDisabled:!1}},computed:{...(0,i.aH)(["clients"]),...(0,i.aH)(["shifts"]),isEngineer(){return"Engineer"===this.userProfile.role}},methods:{...(0,i.i0)(["fetchClientSLAQuotas","updateClientSLAQuotas","fetchShifts","fetchShiftDetails","updateShiftDetails","addToast"]),openSettingsModal(){const e=new(l().Modal)(document.getElementById("settingsModal"));e.show()},async toggleFunctionState(){try{const e=!this.functionDisabled,t="/api/disable-function";await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({disable:e})}),this.functionDisabled=e,this.addToast({message:"Azure Function successfully "+(e?"disabled":"enabled"),type:"success"})}catch(e){console.error("Error toggling Azure Function:",e),this.addToast({message:"Failed to toggle Azure Function",type:"danger"})}},async fetchFunctionStatus(){try{const e=await fetch("/api/function-status"),t=await e.json();this.functionDisabled=t.disabled}catch(e){console.error("Error fetching Azure Function status:",e),this.addToast({message:"Failed to fetch Azure Function status",type:"danger"})}},async fetchSLAQuotas(){try{const e=await this.$store.dispatch("fetchClientSLAQuotas",this.selectedClientId);e&&(this.slaQuotas=e.slaQuotas,console.log("SLA Quotas fetched:",this.slaQuotas))}catch(e){this.addToast({message:"Failed to fetch SLA Quotas",type:"danger"})}},async saveSlaChanges(){try{await this.$store.dispatch("updateClientSLAQuotas",{clientId:this.selectedClientId,slaQuotas:this.slaQuotas}),this.addToast({message:"SLA Quotas updated successfully",type:"success"})}catch(e){this.addToast({message:"Failed to update SLA Quotas",type:"error"})}},async fetchShiftDetails(){try{const e=await this.$store.dispatch("fetchShiftDetails",this.selectedShiftId);this.currentShift=e||{title:"",engineers:[{name:""},{name:""},{name:""},{name:""}]}}catch(e){this.addToast({message:"Failed to fetch shift details",type:"danger"})}},async saveShiftChanges(){try{await this.$store.dispatch("updateShiftDetails",this.currentShift),this.addToast({message:"Shift updated successfully",type:"success"})}catch(e){this.addToast({message:"Failed to update shift",type:"danger"})}},async saveNewClient(){if(this.newClientName)try{const e={client:this.newClientName,slaQuotas:this.newClientQuotas};await this.$store.dispatch("createNewClient",e),this.newClientName="",this.newClientQuotas={quota_P1:"",quota_P2:"",quota_P3:"",quota_P4:""},this.fetchClients()}catch(e){console.error("Error adding new client:",e),this.addToast({message:"Failed to add new client",type:"danger"})}else this.addToast({message:"Client name is required",type:"danger"})}},mounted(){this.$store.dispatch("fetchClients"),this.$store.dispatch("fetchShifts"),this.fetchFunctionStatus()}};const Pt=(0,E.A)(yt,[["render",Lt],["__scopeId","data-v-2d80af12"]]);var wt=Pt,Ct={name:"NavBarComponent",components:{SLAProgressModal:ke,settingsModal:wt},data(){return{userProfile:{displayName:localStorage.getItem("user")},searchTerm:""}},computed:{...(0,i.aH)(["searchResults"]),searchResults(){return this.$store.state.searchResults}},methods:{...(0,i.i0)(["debouncedPerformSearch","fetchPageDetails"]),loadPage(e){this.fetchPageDetails(e),this.clearSearchResults()},performSearch(){this.$store.dispatch("debouncedPerformSearch",this.searchTerm)},openSlaModal(){this.$refs.slaModal.openSlaModal()},openSettingsModal(){this.$refs.settingsModal.openSettingsModal()},clearSearchResults(){this.$store.commit("setSearchResults",[])},handleClickOutside(e){this.$el.contains(e.target)||this.clearSearchResults()}},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}};const St=(0,E.A)(Ct,[["render",se],["__scopeId","data-v-0cc27aec"]]);var Et=St;const It={class:"sidebar-comp d-flex flex-column"},Nt={class:"flex-shrink-0 p-3 bg-light"},qt={class:"pb-3 mb-3 border-bottom"},Tt={class:"nav-pills-wrapper flex-grow-1 overflow-auto"},Dt={class:"nav nav-pills flex-column"},At=["onClick"],Ut=(0,b.Lk)("button",{class:"btn btn-secondary dropdown-toggle w-100",type:"button",id:"dropupMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false"}," New Page ",-1),Mt={class:"dropdown-menu w-100","aria-labelledby":"dropupMenuButton"};function _t(e,t,a,o,n,l){return(0,b.uX)(),(0,b.CE)("div",It,[(0,b.Lk)("div",Nt,[(0,b.Lk)("div",qt,[(0,b.bo)((0,b.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.searchQuery=e),type:"text",class:"form-control",placeholder:"Enter page title"},null,512),[[s.Jo,n.searchQuery]])])]),(0,b.Lk)("div",Tt,[(0,b.Lk)("ul",Dt,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(l.filteredPages,(t=>((0,b.uX)(),(0,b.CE)("li",{class:"nav-item",key:t.id},[(0,b.Lk)("a",{href:"#",class:(0,k.C4)(["nav-link link-dark",{active:t.id===e.currentPage?.id}]),onClick:e=>l.loadPage(t.id)},(0,k.v_)(t.title),11,At)])))),128))])]),(0,b.Lk)("div",{class:(0,k.C4)({dropup:!0,disabled:!l.isEngineer})},[Ut,(0,b.Lk)("ul",Mt,[(0,b.Lk)("li",null,[(0,b.Lk)("a",{class:"dropdown-item",href:"#",onClick:t[1]||(t[1]=(...e)=>l.createNewHandoverWithData&&l.createNewHandoverWithData(...e))},"Copy last handover")]),(0,b.Lk)("li",null,[(0,b.Lk)("a",{class:"dropdown-item",href:"#",onClick:t[2]||(t[2]=(...e)=>l.createNewTemplateHandover&&l.createNewTemplateHandover(...e))},"Create a new page")])])],2)])}var $t={name:"SidebarComponent",data(){return{searchQuery:"",userProfile:{role:localStorage.getItem("roles")},socketId:null}},computed:{...(0,i.aH)(["pages","currentPage"]),filteredPages(){const e=[...this.pages].sort(((e,t)=>new Date(t.date)-new Date(e.date)));return this.searchQuery?e.filter((e=>e.title.toLowerCase().includes(this.searchQuery.toLowerCase()))):e},isEngineer(){return"Engineer"===this.userProfile.role}},methods:{...(0,i.i0)(["fetchPages","fetchPageDetails","debouncedCreateHandoverTemplate","debouncedCopyHandover","addToast"]),...(0,i.PY)(["setCurrentPage"]),loadPage(e){const t=localStorage.getItem("userName");this.fetchPageDetails(e),this.$socket.emit("viewPage",{pageId:e,userName:t}),console.log(this.userProfile.role)},createNewHandoverWithData(){this.debouncedCopyHandover().then((e=>{this.setCurrentPage(e)})).catch((e=>{this.addToast({message:`Error: ${e.message}`,type:"danger"})}))},createNewTemplateHandover(){this.debouncedCreateHandoverTemplate().then((e=>{this.setCurrentPage(e)})).catch((e=>{this.addToast({message:`Failed to create template ${e.message}`,type:"danger"})}))}},created(){this.fetchPages(),this.$socket.on("connect",(()=>{this.socketId=this.$socket.id})),this.$socket.on("pageCreated",(e=>{e.createdBy!==this.socketId?this.addToast({message:"A new handover page was created.",type:"success"}):this.setCurrentPage(e)})),this.$socket.on("pageDeleted",(e=>{this.$store.commit("deletePage",e.id),this.addToast({message:`Page "${e.title}" has been deleted.`,type:"danger"})}))},beforeUnmount(){this.$socket.off("pageCreated"),this.$socket.off("pageDeleted"),this.$socket.off("usersOnPage")}};const xt=(0,E.A)($t,[["render",_t]]);var Rt=xt;const Qt=e=>((0,b.Qi)("data-v-e95e601c"),e=e(),(0,b.jt)(),e),Ot={id:"content-container",class:"container mt-4"},Xt={key:0,class:"main-container"},Vt={class:"header"},Ft={class:"text-muted fst-italic",style:{"margin-top":"20px"}},jt={class:(0,k.C4)({"dropwdowns-opt":!0})},Jt=["disabled"],Ht=Qt((()=>(0,b.Lk)("i",{class:"bi bi-plus-lg"},null,-1))),Bt=[Ht],Kt=(0,b.Fv)('<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton" data-v-e95e601c><li data-v-e95e601c><a class="dropdown-item" id="add-inc-btn" href="#" data-bs-toggle="modal" data-bs-target="#addIncidentModal" data-v-e95e601c>Add Incident</a></li><li data-v-e95e601c><a class="dropdown-item" id="add-prb-btn" href="#" data-bs-toggle="modal" data-bs-target="#addProblemModal" data-v-e95e601c>Add Problem</a></li><li data-v-e95e601c><a class="dropdown-item" id="add-chg-btn" href="#" data-bs-toggle="modal" data-bs-target="#addChangeModal" data-v-e95e601c>Add Change</a></li><li data-v-e95e601c><a class="dropdown-item" id="add-req-btn" href="#" data-bs-toggle="modal" data-bs-target="#addRequestModal" data-v-e95e601c>Add Service Request</a></li></ul>',1),zt=(0,b.Fv)('<button class="btn btn-link text-decoration-none" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false" data-v-e95e601c><i class="bi bi-upload" data-v-e95e601c></i></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton" data-v-e95e601c><li data-v-e95e601c><a class="dropdown-item" id="add-inc-btn" href="#" data-bs-toggle="modal" data-bs-target="#importIncidentsModal" data-v-e95e601c>Import Incidents</a></li><li data-v-e95e601c><a class="dropdown-item" id="add-prb-btn" href="#" data-bs-toggle="modal" data-bs-target="#importProblemsModal" data-v-e95e601c>Import Problems</a></li><li data-v-e95e601c><a class="dropdown-item" id="add-chg-btn" href="#" data-bs-toggle="modal" data-bs-target="#importChangesModal" data-v-e95e601c>Import Changes</a></li><li data-v-e95e601c><a class="dropdown-item" id="add-req-btn" href="#" data-bs-toggle="modal" data-bs-target="#importReqModal" data-v-e95e601c>Import Service Requests</a></li></ul>',2),Wt=[zt],Yt={class:"dropdown"},Gt=Qt((()=>(0,b.Lk)("button",{class:"btn btn-link text-decoration-none",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,b.Lk)("i",{class:"bi bi-three-dots-vertical"})],-1))),Zt={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdownMenuButton"},ea=Qt((()=>(0,b.Lk)("li",null,[(0,b.Lk)("hr",{class:"dropdown-divider"})],-1))),ta={class:"modal fade",id:"addIncidentModal",tabindex:"-1","aria-labelledby":"addIncidentModalLabel","aria-hidden":"true"},aa={class:"modal-dialog"},sa={class:"modal-content"},oa=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"addIncidentModalLabel"},"Add Incident"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),na={class:"modal-body"},la={class:"mb-3"},ia=Qt((()=>(0,b.Lk)("label",{for:"clientSelect",class:"form-label"},"Client",-1))),ra=["value"],da={class:"mb-3"},ca=Qt((()=>(0,b.Lk)("label",{for:"incidentNumber",class:"form-label"},"Incident Number",-1))),ua={class:"mb-3"},ma=Qt((()=>(0,b.Lk)("label",{for:"status",class:"form-label"},"Status",-1))),pa=Qt((()=>(0,b.Lk)("option",{value:"Active"},"Active",-1))),ha=Qt((()=>(0,b.Lk)("option",{value:"Awaiting user info"},"Awaiting User Info",-1))),ga=Qt((()=>(0,b.Lk)("option",{value:"Awaiting third party"},"Awaiting Third Party",-1))),ba=Qt((()=>(0,b.Lk)("option",{value:"Resolved"},"Resolved",-1))),ka=[pa,ha,ga,ba],va={class:"mb-3"},fa=Qt((()=>(0,b.Lk)("label",{for:"dateOpened",class:"form-label"},"Date Opened",-1))),La=["max"],ya={class:"mb-3"},Pa=Qt((()=>(0,b.Lk)("label",{for:"priority",class:"form-label"},"Priority",-1))),wa=Qt((()=>(0,b.Lk)("option",{value:"P4 - Low"},"P4 - Low",-1))),Ca=Qt((()=>(0,b.Lk)("option",{value:"P3 - moderate"},"P3 - moderate",-1))),Sa=Qt((()=>(0,b.Lk)("option",{value:"P2 - high"},"P2 - high",-1))),Ea=Qt((()=>(0,b.Lk)("option",{value:"P1 - Critical"},"P1 - Critical",-1))),Ia=[wa,Ca,Sa,Ea],Na={class:"mb-3"},qa=Qt((()=>(0,b.Lk)("label",{for:"mainProblem",class:"form-label"},"Main Problem",-1))),Ta={class:"mb-3"},Da=Qt((()=>(0,b.Lk)("label",{for:"notes",class:"form-label"},"Notes",-1))),Aa=Qt((()=>(0,b.Lk)("div",{class:"modal-footer"},[(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),(0,b.Lk)("button",{type:"submit",class:"btn btn-primary"},"Save")],-1))),Ua={class:"modal fade",id:"importIncidentsModal",tabindex:"-1","aria-labelledby":"importModalLabel","aria-hidden":"true"},Ma={class:"modal-dialog"},_a={class:"modal-content"},$a=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"importModalLabel"},"Import Incidents"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),xa={class:"modal-body"},Ra={class:"mb-3"},Qa=Qt((()=>(0,b.Lk)("label",{for:"clientNameInput",class:"form-label"},"Client Name",-1))),Oa=["value"],Xa={class:"modal-footer"},Va=Qt((()=>(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1))),Fa={class:"modal fade",id:"addProblemModal",tabindex:"-1","aria-labelledby":"addProblemModalLabel","aria-hidden":"true"},ja={class:"modal-dialog"},Ja={class:"modal-content"},Ha=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"addProblemModalLabel"},"Add Problem"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Ba={class:"modal-body"},Ka={class:"mb-3"},za=Qt((()=>(0,b.Lk)("label",{for:"clientSelect",class:"form-label"},"Client",-1))),Wa=Qt((()=>(0,b.Lk)("option",null,"Client1",-1))),Ya=[Wa],Ga={class:"mb-3"},Za=Qt((()=>(0,b.Lk)("label",{for:"problemNumber",class:"form-label"},"Problem Number",-1))),es={class:"mb-3"},ts=Qt((()=>(0,b.Lk)("label",{for:"status",class:"form-label"},"Status",-1))),as=(0,b.Fv)('<option value="Evaluate" data-v-e95e601c>Evaluate</option><option value="On Hold" data-v-e95e601c>On Hold</option><option value="Investigate" data-v-e95e601c>Investigate</option><option value="Review" data-v-e95e601c>Review</option><option value="Remediate" data-v-e95e601c>Remediate</option><option value="Resolved" data-v-e95e601c>Resolved</option>',6),ss=[as],os={class:"mb-3"},ns=Qt((()=>(0,b.Lk)("label",{for:"priority",class:"form-label"},"Priority",-1))),ls=Qt((()=>(0,b.Lk)("option",{value:"P4 - Low"},"P4 - Low",-1))),is=Qt((()=>(0,b.Lk)("option",{value:"P3 - moderate"},"P3 - moderate",-1))),rs=Qt((()=>(0,b.Lk)("option",{value:"P2 - high"},"P2 - high",-1))),ds=Qt((()=>(0,b.Lk)("option",{value:"P1 - Critical"},"P1 - Critical",-1))),cs=[ls,is,rs,ds],us={class:"mb-3"},ms=Qt((()=>(0,b.Lk)("label",{for:"rca",class:"form-label"},"Root cause analysis summary",-1))),ps={class:"mb-3"},hs=Qt((()=>(0,b.Lk)("label",{for:"notes",class:"form-label"},"Notes",-1))),gs=Qt((()=>(0,b.Lk)("div",{class:"modal-footer"},[(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),(0,b.Lk)("button",{type:"submit",class:"btn btn-primary"},"Save")],-1))),bs={class:"modal fade",id:"importProblemsModal",tabindex:"-1","aria-labelledby":"importModalLabel","aria-hidden":"true"},ks={class:"modal-dialog"},vs={class:"modal-content"},fs=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"importModalLabel"},"Import Problems"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Ls={class:"modal-body"},ys={class:"mb-3"},Ps=Qt((()=>(0,b.Lk)("label",{for:"clientNameInput",class:"form-label"},"Client Name",-1))),ws=["value"],Cs={class:"modal-footer"},Ss=Qt((()=>(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1))),Es={class:"modal fade",id:"importChangesModal",tabindex:"-1","aria-labelledby":"importModalLabel","aria-hidden":"true"},Is={class:"modal-dialog"},Ns={class:"modal-content"},qs=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"importModalLabel"},"Import Changes"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Ts={class:"modal-body"},Ds={class:"mb-3"},As=Qt((()=>(0,b.Lk)("label",{for:"clientNameInput",class:"form-label"},"Client Name",-1))),Us=["value"],Ms={class:"modal-footer"},_s=Qt((()=>(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1))),$s={class:"modal fade",id:"importReqModal",tabindex:"-1","aria-labelledby":"importModalLabel","aria-hidden":"true"},xs={class:"modal-dialog"},Rs={class:"modal-content"},Qs=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"importModalLabel"},"Import Changes"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Os={class:"modal-body"},Xs={class:"mb-3"},Vs=Qt((()=>(0,b.Lk)("label",{for:"clientNameInput",class:"form-label"},"Client Name",-1))),Fs=["value"],js={class:"modal-footer"},Js=Qt((()=>(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1))),Hs={class:"modal fade",id:"addChangeModal",tabindex:"-1","aria-labelledby":"addChangeModalLabel","aria-hidden":"true"},Bs={class:"modal-dialog"},Ks={class:"modal-content"},zs=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"addChangeModalLabel"},"Add Change"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Ws={class:"modal-body"},Ys={class:"mb-3"},Gs=Qt((()=>(0,b.Lk)("label",{for:"clientSelect",class:"form-label"},"Client",-1))),Zs=Qt((()=>(0,b.Lk)("option",null,"Client1",-1))),eo=[Zs],to={class:"mb-3"},ao=Qt((()=>(0,b.Lk)("label",{for:"changeNumber",class:"form-label"},"Change Number",-1))),so={class:"mb-3"},oo=Qt((()=>(0,b.Lk)("label",{for:"status",class:"form-label"},"Status",-1))),no=(0,b.Fv)('<option value="New" data-v-e95e601c>New</option><option value="Assess" data-v-e95e601c>Assess</option><option value="Authorize" data-v-e95e601c>Authorize</option><option value="Scheduled" data-v-e95e601c>Scheduled</option><option value="Implement" data-v-e95e601c>Implement</option><option value="Review" data-v-e95e601c>Review</option><option value="Closed" data-v-e95e601c>Closed</option>',7),lo=[no],io={class:"mb-3"},ro=Qt((()=>(0,b.Lk)("label",{for:"startDate",class:"form-label"},"Start Date",-1))),co={class:"mb-3"},uo=Qt((()=>(0,b.Lk)("label",{for:"endDate",class:"form-label"},"End Date",-1))),mo={class:"mb-3"},po=Qt((()=>(0,b.Lk)("label",{for:"notes",class:"form-label"},"Notes",-1))),ho=Qt((()=>(0,b.Lk)("div",{class:"modal-footer"},[(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),(0,b.Lk)("button",{type:"submit",class:"btn btn-primary"},"Save")],-1))),go={class:"modal fade",id:"addRequestModal",tabindex:"-1","aria-labelledby":"addRequestModalLabel","aria-hidden":"true"},bo={class:"modal-dialog"},ko={class:"modal-content"},vo=Qt((()=>(0,b.Lk)("div",{class:"modal-header"},[(0,b.Lk)("h5",{class:"modal-title",id:"addRequestModalLabel"},"Add Service Request"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),fo={class:"modal-body"},Lo={class:"mb-3"},yo=Qt((()=>(0,b.Lk)("label",{for:"clientSelect",class:"form-label"},"Client",-1))),Po=Qt((()=>(0,b.Lk)("option",null,"Client1",-1))),wo=[Po],Co={class:"mb-3"},So=Qt((()=>(0,b.Lk)("label",{for:"ritmNumber",class:"form-label"},"Service Request Number",-1))),Eo={class:"mb-3"},Io=Qt((()=>(0,b.Lk)("label",{for:"status",class:"form-label"},"Status",-1))),No=(0,b.Fv)('<option value="Draft" data-v-e95e601c>Draft</option><option value="Awaiting Approval" data-v-e95e601c>Awaiting Approval</option><option value="Pending" data-v-e95e601c>Pending</option><option value="Work in Progress" data-v-e95e601c>Work in Progress</option><option value="Closed" data-v-e95e601c>Closed</option>',5),qo=[No],To={class:"mb-3"},Do=Qt((()=>(0,b.Lk)("label",{for:"notes",class:"form-label"},"Short request description",-1))),Ao={class:"mb-3"},Uo=Qt((()=>(0,b.Lk)("label",{for:"notes",class:"form-label"},"Notes",-1))),Mo=Qt((()=>(0,b.Lk)("div",{class:"modal-footer"},[(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),(0,b.Lk)("button",{type:"submit",class:"btn btn-primary"},"Save")],-1))),_o={class:"modal fade",id:"removePageModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},$o={class:"modal-dialog modal-dialog-centered"},xo={class:"modal-content"},Ro={class:"modal-body"},Qo={class:"modal-footer"},Oo=Qt((()=>(0,b.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1))),Xo={class:"toast-container position-fixed bottom-0 end-0 p-3"},Vo={id:"liveToast",class:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},Fo=Qt((()=>(0,b.Lk)("div",{class:"toast-header"},[(0,b.Lk)("strong",{class:"me-auto"},"Bootstrap"),(0,b.Lk)("small",null,"11 mins ago"),(0,b.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"})],-1))),jo={class:"toast-body"},Jo=Qt((()=>(0,b.Lk)("h5",null,"Engineers on Shift",-1))),Ho={key:0},Bo={key:1},Ko=["value"],zo={key:0},Wo=Qt((()=>(0,b.Lk)("h6",null,"Incidents",-1))),Yo={class:"table table-fixed"},Go=Qt((()=>(0,b.Lk)("thead",null,[(0,b.Lk)("tr",null,[(0,b.Lk)("th",null,"Incident Number"),(0,b.Lk)("th",null,"Status"),(0,b.Lk)("th",null,"Priority"),(0,b.Lk)("th",null,"Date Opened"),(0,b.Lk)("th",{class:"main-problem"},"Main Problem"),(0,b.Lk)("th",null,"Notes")])],-1))),Zo={key:0},en={key:1},tn=["onUpdate:modelValue"],an=Qt((()=>(0,b.Lk)("option",{value:"Active"},"Active",-1))),sn=Qt((()=>(0,b.Lk)("option",{value:"Awaiting user info"},"Awaiting User Info",-1))),on=Qt((()=>(0,b.Lk)("option",{value:"Awaiting third party"},"Awaiting Third Party",-1))),nn=Qt((()=>(0,b.Lk)("option",{value:"Resolved"},"Resolved",-1))),ln=[an,sn,on,nn],rn={key:0},dn={key:1},cn=["onUpdate:modelValue"],un=Qt((()=>(0,b.Lk)("option",{value:"P4 - Low"},"P4 - Low",-1))),mn=Qt((()=>(0,b.Lk)("option",{value:"P3 - moderate"},"P3 - moderate",-1))),pn=Qt((()=>(0,b.Lk)("option",{value:"P2 - high"},"P2 - high",-1))),hn=Qt((()=>(0,b.Lk)("option",{value:"P1 - Critical"},"P1 - Critical",-1))),gn=[un,mn,pn,hn],bn={key:0},kn={key:1},vn=["onUpdate:modelValue","max"],fn={class:"main-problem"},Ln={key:0},yn={key:1},Pn=["onUpdate:modelValue"],wn={key:0},Cn={key:1},Sn=["onUpdate:modelValue"],En={key:1},In=Qt((()=>(0,b.Lk)("h6",null,"Problems",-1))),Nn={class:"table table-fixed"},qn=Qt((()=>(0,b.Lk)("thead",null,[(0,b.Lk)("tr",null,[(0,b.Lk)("th",null,"Problem Number"),(0,b.Lk)("th",null,"Status"),(0,b.Lk)("th",null,"Priority"),(0,b.Lk)("th",null,"Root cause analysis summary"),(0,b.Lk)("th",null,"Notes")])],-1))),Tn={key:0},Dn={key:1},An=["onUpdate:modelValue"],Un=Qt((()=>(0,b.Lk)("option",{value:"Active"},"Active",-1))),Mn=Qt((()=>(0,b.Lk)("option",{value:"Awaiting user info"},"Awaiting User Info",-1))),_n=Qt((()=>(0,b.Lk)("option",{value:"Awaiting third party"},"Awaiting Third Party",-1))),$n=Qt((()=>(0,b.Lk)("option",{value:"Resolved"},"Resolved",-1))),xn=[Un,Mn,_n,$n],Rn={key:0},Qn={key:1},On=["onUpdate:modelValue"],Xn=Qt((()=>(0,b.Lk)("option",{value:"P4 - Low"},"P4 - Low",-1))),Vn=Qt((()=>(0,b.Lk)("option",{value:"P3 - moderate"},"P3 - moderate",-1))),Fn=Qt((()=>(0,b.Lk)("option",{value:"P2 - high"},"P2 - high",-1))),jn=Qt((()=>(0,b.Lk)("option",{value:"P1 - Critical"},"P1 - Critical",-1))),Jn=[Xn,Vn,Fn,jn],Hn={key:0},Bn={key:1},Kn=["onUpdate:modelValue"],zn={key:0},Wn={key:1},Yn=["onUpdate:modelValue"],Gn={key:2},Zn=Qt((()=>(0,b.Lk)("h6",null,"Changes",-1))),el={class:"table table-fixed"},tl=Qt((()=>(0,b.Lk)("thead",null,[(0,b.Lk)("tr",null,[(0,b.Lk)("th",null,"Change Number"),(0,b.Lk)("th",null,"Status"),(0,b.Lk)("th",null,"Start Date"),(0,b.Lk)("th",null,"End Date"),(0,b.Lk)("th",null,"Notes")])],-1))),al={key:0},sl={key:1},ol=["onUpdate:modelValue"],nl=(0,b.Fv)('<option value="New" data-v-e95e601c>New</option><option value="Assess" data-v-e95e601c>Assess</option><option value="Authorize" data-v-e95e601c>Authorize</option><option value="Scheduled" data-v-e95e601c>Scheduled</option><option value="Implement" data-v-e95e601c>Implement</option><option value="Review" data-v-e95e601c>Review</option><option value="Closed" data-v-e95e601c>Closed</option>',7),ll=[nl],il={key:0},rl={key:1},dl=["onUpdate:modelValue"],cl={key:0},ul={key:1},ml=["onUpdate:modelValue"],pl={key:0},hl={key:1},gl=["onUpdate:modelValue"],bl={key:3},kl=Qt((()=>(0,b.Lk)("h6",null,"Service Requests",-1))),vl={class:"table table-fixed"},fl=Qt((()=>(0,b.Lk)("thead",null,[(0,b.Lk)("tr",null,[(0,b.Lk)("th",null,"Request Number"),(0,b.Lk)("th",null,"Status"),(0,b.Lk)("th",{class:"short-request-description"},"Short request description"),(0,b.Lk)("th",null,"Notes")])],-1))),Ll={key:0},yl={key:1},Pl=["onUpdate:modelValue"],wl=(0,b.Fv)('<option value="Draft" data-v-e95e601c>Draft</option><option value="Awaiting Approval" data-v-e95e601c>Awaiting Approval</option><option value="Pending" data-v-e95e601c>Pending</option><option value="Work in Progress" data-v-e95e601c>Work in Progress</option><option value="Closed" data-v-e95e601c>Closed</option>',5),Cl=[wl],Sl={class:"short-request-description"},El={key:0},Il={key:1},Nl=["onUpdate:modelValue"],ql={key:0},Tl={key:1},Dl=["onUpdate:modelValue"],Al={key:1};function Ul(e,t,a,o,n,l){return(0,b.uX)(),(0,b.CE)("div",Ot,[e.currentPage?((0,b.uX)(),(0,b.CE)("div",Xt,[(0,b.Lk)("div",Vt,[(0,b.Lk)("h1",null,(0,k.v_)(e.currentPage.title),1),(0,b.Lk)("p",Ft,"Last edited by: "+(0,k.v_)(e.currentPage.lastEditedBy),1),(0,b.Lk)("div",jt,[(0,b.Lk)("div",{class:(0,k.C4)({"dropdown-add":!0,disabled:!l.isEngineer})},[(0,b.Lk)("button",{class:"btn btn-link text-decoration-none",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:!l.isEngineer},Bt,8,Jt),Kt],2),(0,b.Lk)("div",{class:(0,k.C4)({"dropdown-import":!0,disabled:!l.isEngineer})},Wt,2),(0,b.Lk)("div",Yt,[Gt,(0,b.Lk)("ul",Zt,[(0,b.Lk)("li",null,[(0,b.Lk)("a",{class:(0,k.C4)({"dropdown-item":!0,disabled:!l.isEngineer||l.isLocked&&!n.editMode}),onClick:t[0]||(t[0]=(...e)=>l.toggleEditMode&&l.toggleEditMode(...e))},(0,k.v_)(n.editMode?"Save":"Edit"),3)]),ea,(0,b.Lk)("li",null,[(0,b.Lk)("a",{id:"remove-btn",href:"#",class:(0,k.C4)({"dropdown-item":!0,disabled:!l.isEngineer||n.editMode}),"data-bs-toggle":"modal","data-bs-target":"#removePageModal"}," Remove page ",2)])])])])]),(0,b.Lk)("div",ta,[(0,b.Lk)("div",aa,[(0,b.Lk)("div",sa,[oa,(0,b.Lk)("div",na,[(0,b.Lk)("form",{onSubmit:t[8]||(t[8]=(0,s.D$)(((...e)=>l.saveIncident&&l.saveIncident(...e)),["prevent"]))},[(0,b.Lk)("div",la,[ia,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"clientSelect","onUpdate:modelValue":t[1]||(t[1]=e=>n.newIncident.client=e),required:""},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.clients,(e=>((0,b.uX)(),(0,b.CE)("option",{value:e.id,key:e.id},(0,k.v_)(e.client),9,ra)))),128))],512),[[s.u1,n.newIncident.client]])]),(0,b.Lk)("div",da,[ca,(0,b.bo)((0,b.Lk)("input",{type:"text",class:"form-control",id:"incidentNumber","onUpdate:modelValue":t[2]||(t[2]=e=>n.newIncident.incNumber=e),required:""},null,512),[[s.Jo,n.newIncident.incNumber]])]),(0,b.Lk)("div",ua,[ma,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"status","onUpdate:modelValue":t[3]||(t[3]=e=>n.newIncident.status=e),required:""},ka,512),[[s.u1,n.newIncident.status]])]),(0,b.Lk)("div",va,[fa,(0,b.bo)((0,b.Lk)("input",{type:"datetime-local",class:"form-control",id:"dateOpened","onUpdate:modelValue":t[4]||(t[4]=e=>n.newIncident.dateOpened=e),max:l.maxDate,required:""},null,8,La),[[s.Jo,n.newIncident.dateOpened]])]),(0,b.Lk)("div",ya,[Pa,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"priority","onUpdate:modelValue":t[5]||(t[5]=e=>n.newIncident.priority=e),required:""},Ia,512),[[s.u1,n.newIncident.priority]])]),(0,b.Lk)("div",Na,[qa,(0,b.bo)((0,b.Lk)("input",{type:"text",class:"form-control",id:"mainProblem","onUpdate:modelValue":t[6]||(t[6]=e=>n.newIncident.mainProblem=e),required:""},null,512),[[s.Jo,n.newIncident.mainProblem]])]),(0,b.Lk)("div",Ta,[Da,(0,b.bo)((0,b.Lk)("textarea",{class:"form-control",id:"notes","onUpdate:modelValue":t[7]||(t[7]=e=>n.newIncident.notes=e),rows:"3"},null,512),[[s.Jo,n.newIncident.notes]])]),Aa],32)])])])]),(0,b.Lk)("div",Ua,[(0,b.Lk)("div",Ma,[(0,b.Lk)("div",_a,[$a,(0,b.Lk)("div",xa,[(0,b.Lk)("div",Ra,[Qa,(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>n.selectedClient=e),id:"clientSelect",class:"form-select"},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.clients,(e=>((0,b.uX)(),(0,b.CE)("option",{key:e.id,value:e.client},(0,k.v_)(e.client),9,Oa)))),128))],512),[[s.u1,n.selectedClient]])]),(0,b.Lk)("input",{type:"file",onChange:t[10]||(t[10]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e)),accept:".json"},null,32)]),(0,b.Lk)("div",Xa,[Va,(0,b.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[11]||(t[11]=(...e)=>l.importIncidentRecords&&l.importIncidentRecords(...e))},"Import")])])])]),(0,b.Lk)("div",Fa,[(0,b.Lk)("div",ja,[(0,b.Lk)("div",Ja,[Ha,(0,b.Lk)("div",Ba,[(0,b.Lk)("form",{onSubmit:t[18]||(t[18]=(0,s.D$)(((...e)=>l.saveProblem&&l.saveProblem(...e)),["prevent"]))},[(0,b.Lk)("div",Ka,[za,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"clientSelect","onUpdate:modelValue":t[12]||(t[12]=e=>n.newProblem.client=e),required:""},Ya,512),[[s.u1,n.newProblem.client]])]),(0,b.Lk)("div",Ga,[Za,(0,b.bo)((0,b.Lk)("input",{type:"text",class:"form-control",id:"problemNumber","onUpdate:modelValue":t[13]||(t[13]=e=>n.newProblem.prbNumber=e),required:""},null,512),[[s.Jo,n.newProblem.prbNumber]])]),(0,b.Lk)("div",es,[ts,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"status","onUpdate:modelValue":t[14]||(t[14]=e=>n.newProblem.status=e),required:""},ss,512),[[s.u1,n.newProblem.status]])]),(0,b.Lk)("div",os,[ns,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"priority","onUpdate:modelValue":t[15]||(t[15]=e=>n.newProblem.priority=e),required:""},cs,512),[[s.u1,n.newProblem.priority]])]),(0,b.Lk)("div",us,[ms,(0,b.bo)((0,b.Lk)("input",{type:"text",class:"form-control",id:"rca","onUpdate:modelValue":t[16]||(t[16]=e=>n.newProblem.rca=e),required:""},null,512),[[s.Jo,n.newProblem.rca]])]),(0,b.Lk)("div",ps,[hs,(0,b.bo)((0,b.Lk)("textarea",{class:"form-control",id:"notes","onUpdate:modelValue":t[17]||(t[17]=e=>n.newProblem.notes=e),rows:"3"},null,512),[[s.Jo,n.newProblem.notes]])]),gs],32)])])])]),(0,b.Lk)("div",bs,[(0,b.Lk)("div",ks,[(0,b.Lk)("div",vs,[fs,(0,b.Lk)("div",Ls,[(0,b.Lk)("div",ys,[Ps,(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t[19]||(t[19]=e=>n.selectedClient=e),id:"clientSelect",class:"form-select"},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.clients,(e=>((0,b.uX)(),(0,b.CE)("option",{key:e.id,value:e.client},(0,k.v_)(e.client),9,ws)))),128))],512),[[s.u1,n.selectedClient]])]),(0,b.Lk)("input",{type:"file",onChange:t[20]||(t[20]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e)),accept:".json"},null,32)]),(0,b.Lk)("div",Cs,[Ss,(0,b.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[21]||(t[21]=(...e)=>l.importProblemRecords&&l.importProblemRecords(...e))},"Import")])])])]),(0,b.Lk)("div",Es,[(0,b.Lk)("div",Is,[(0,b.Lk)("div",Ns,[qs,(0,b.Lk)("div",Ts,[(0,b.Lk)("div",Ds,[As,(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t[22]||(t[22]=e=>n.selectedClient=e),id:"clientSelect",class:"form-select"},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.clients,(e=>((0,b.uX)(),(0,b.CE)("option",{key:e.id,value:e.client},(0,k.v_)(e.client),9,Us)))),128))],512),[[s.u1,n.selectedClient]])]),(0,b.Lk)("input",{type:"file",onChange:t[23]||(t[23]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e)),accept:".json"},null,32)]),(0,b.Lk)("div",Ms,[_s,(0,b.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[24]||(t[24]=(...e)=>l.importChangeRecords&&l.importChangeRecords(...e))},"Import")])])])]),(0,b.Lk)("div",$s,[(0,b.Lk)("div",xs,[(0,b.Lk)("div",Rs,[Qs,(0,b.Lk)("div",Os,[(0,b.Lk)("div",Xs,[Vs,(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t[25]||(t[25]=e=>n.selectedClient=e),id:"clientSelect",class:"form-select"},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.clients,(e=>((0,b.uX)(),(0,b.CE)("option",{key:e.id,value:e.client},(0,k.v_)(e.client),9,Fs)))),128))],512),[[s.u1,n.selectedClient]])]),(0,b.Lk)("input",{type:"file",onChange:t[26]||(t[26]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e)),accept:".json"},null,32)]),(0,b.Lk)("div",js,[Js,(0,b.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[27]||(t[27]=(...e)=>l.importRequestRecords&&l.importRequestRecords(...e))},"Import")])])])]),(0,b.Lk)("div",Hs,[(0,b.Lk)("div",Bs,[(0,b.Lk)("div",Ks,[zs,(0,b.Lk)("div",Ws,[(0,b.Lk)("form",{onSubmit:t[34]||(t[34]=(0,s.D$)(((...e)=>l.saveChange&&l.saveChange(...e)),["prevent"]))},[(0,b.Lk)("div",Ys,[Gs,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"clientSelect","onUpdate:modelValue":t[28]||(t[28]=e=>n.newChange.client=e),required:""},eo,512),[[s.u1,n.newChange.client]])]),(0,b.Lk)("div",to,[ao,(0,b.bo)((0,b.Lk)("input",{type:"text",class:"form-control",id:"changeNumber","onUpdate:modelValue":t[29]||(t[29]=e=>n.newChange.chgNumber=e),required:""},null,512),[[s.Jo,n.newChange.chgNumber]])]),(0,b.Lk)("div",so,[oo,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"status","onUpdate:modelValue":t[30]||(t[30]=e=>n.newChange.status=e),required:""},lo,512),[[s.u1,n.newChange.status]])]),(0,b.Lk)("div",io,[ro,(0,b.bo)((0,b.Lk)("input",{type:"datetime-local",class:"form-control",id:"startDate","onUpdate:modelValue":t[31]||(t[31]=e=>n.newChange.startDate=e),required:""},null,512),[[s.Jo,n.newChange.startDate]])]),(0,b.Lk)("div",co,[uo,(0,b.bo)((0,b.Lk)("input",{type:"datetime-local",class:"form-control",id:"endDate","onUpdate:modelValue":t[32]||(t[32]=e=>n.newChange.endDate=e),required:""},null,512),[[s.Jo,n.newChange.endDate]])]),(0,b.Lk)("div",mo,[po,(0,b.bo)((0,b.Lk)("textarea",{class:"form-control",id:"notes","onUpdate:modelValue":t[33]||(t[33]=e=>n.newChange.notes=e),rows:"3"},null,512),[[s.Jo,n.newChange.notes]])]),ho],32)])])])]),(0,b.Lk)("div",go,[(0,b.Lk)("div",bo,[(0,b.Lk)("div",ko,[vo,(0,b.Lk)("div",fo,[(0,b.Lk)("form",{onSubmit:t[40]||(t[40]=(0,s.D$)(((...e)=>l.saveRequest&&l.saveRequest(...e)),["prevent"]))},[(0,b.Lk)("div",Lo,[yo,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"clientSelect","onUpdate:modelValue":t[35]||(t[35]=e=>n.newRequest.client=e),required:""},wo,512),[[s.u1,n.newRequest.client]])]),(0,b.Lk)("div",Co,[So,(0,b.bo)((0,b.Lk)("input",{type:"text",class:"form-control",id:"ritmNumber","onUpdate:modelValue":t[36]||(t[36]=e=>n.newRequest.ritmNumber=e),required:""},null,512),[[s.Jo,n.newRequest.ritmNumber]])]),(0,b.Lk)("div",Eo,[Io,(0,b.bo)((0,b.Lk)("select",{class:"form-select",id:"status","onUpdate:modelValue":t[37]||(t[37]=e=>n.newRequest.status=e),required:""},qo,512),[[s.u1,n.newRequest.status]])]),(0,b.Lk)("div",To,[Do,(0,b.bo)((0,b.Lk)("textarea",{class:"form-control",id:"notes","onUpdate:modelValue":t[38]||(t[38]=e=>n.newRequest.short_description=e),rows:"3",required:""},null,512),[[s.Jo,n.newRequest.short_description]])]),(0,b.Lk)("div",Ao,[Uo,(0,b.bo)((0,b.Lk)("textarea",{class:"form-control",id:"notes","onUpdate:modelValue":t[39]||(t[39]=e=>n.newRequest.notes=e),rows:"3"},null,512),[[s.Jo,n.newRequest.notes]])]),Mo],32)])])])]),(0,b.Lk)("div",_o,[(0,b.Lk)("div",$o,[(0,b.Lk)("div",xo,[(0,b.Lk)("div",Ro," Are you sure you want to remove "+(0,k.v_)(e.currentPage.title)+"? This action cannot be undone. ",1),(0,b.Lk)("div",Qo,[Oo,(0,b.Lk)("button",{type:"button",class:"btn btn-primary",id:"liveToastBtn",onClick:t[41]||(t[41]=(...e)=>l.removePage&&l.removePage(...e)),"data-bs-dismiss":"modal"},"Remove")])])])]),(0,b.Lk)("div",Xo,[(0,b.Lk)("div",Vo,[Fo,(0,b.Lk)("div",jo,(0,k.v_)(e.currentPage.title)+" successfully deleted. ",1)])]),(0,b.Lk)("div",null,[Jo,n.editMode?((0,b.uX)(),(0,b.CE)("div",Bo,[(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t[42]||(t[42]=t=>e.selectedShiftId=t),onChange:t[43]||(t[43]=(...e)=>l.updateEngineersOnShift&&l.updateEngineersOnShift(...e))},[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.shifts,(e=>((0,b.uX)(),(0,b.CE)("option",{key:e.id,value:e.id},(0,k.v_)(e.title),9,Ko)))),128))],544),[[s.u1,e.selectedShiftId]])])):((0,b.uX)(),(0,b.CE)("div",Ho,[(0,b.Lk)("ul",null,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.currentPage.engineersOnShift,(e=>((0,b.uX)(),(0,b.CE)("li",{key:e.id},(0,k.v_)(e.name),1)))),128))])]))]),e.currentPage.records&&e.currentPage.records.incidents.length>0?((0,b.uX)(),(0,b.CE)("div",zo,[Wo,(0,b.Lk)("table",Yo,[Go,(0,b.Lk)("tbody",null,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.currentPage.records.incidents,(e=>((0,b.uX)(),(0,b.CE)("tr",{key:e.incNumber,required:""},[(0,b.Lk)("td",null,(0,k.v_)(e.incNumber),1),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",en,[(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t=>e.status=t,required:""},ln,8,tn),[[s.u1,e.status]])])):((0,b.uX)(),(0,b.CE)("div",Zo,(0,k.v_)(e.status),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",dn,[(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t=>e.priority=t,required:""},gn,8,cn),[[s.u1,e.priority]])])):((0,b.uX)(),(0,b.CE)("div",rn,(0,k.v_)(e.priority),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",kn,[(0,b.bo)((0,b.Lk)("input",{type:"datetime-local",class:"form-control",id:"dateOpened","onUpdate:modelValue":t=>e.dateOpened=t,max:l.maxDate,required:""},null,8,vn),[[s.Jo,e.dateOpened]])])):((0,b.uX)(),(0,b.CE)("div",bn,(0,k.v_)(e.dateOpened),1))]),(0,b.Lk)("td",fn,[n.editMode?((0,b.uX)(),(0,b.CE)("div",yn,[(0,b.bo)((0,b.Lk)("textarea",{type:"text","onUpdate:modelValue":t=>e.mainProblem=t,class:"form-control custom-textarea"},null,8,Pn),[[s.Jo,e.mainProblem]])])):((0,b.uX)(),(0,b.CE)("div",Ln,(0,k.v_)(e.mainProblem),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",Cn,[(0,b.bo)((0,b.Lk)("textarea",{type:"text","onUpdate:modelValue":t=>e.notes=t,class:"form-control custom-textarea"},null,8,Sn),[[s.Jo,e.notes]])])):((0,b.uX)(),(0,b.CE)("div",wn,(0,k.v_)(e.notes),1))])])))),128))])])])):(0,b.Q3)("",!0),e.currentPage.records&&e.currentPage.records.problems.length>0?((0,b.uX)(),(0,b.CE)("div",En,[In,(0,b.Lk)("table",Nn,[qn,(0,b.Lk)("tbody",null,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.currentPage.records.problems,(e=>((0,b.uX)(),(0,b.CE)("tr",{key:e.prbNumber,required:""},[(0,b.Lk)("td",null,(0,k.v_)(e.prbNumber),1),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",Dn,[(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t=>e.status=t,required:""},xn,8,An),[[s.u1,e.status]])])):((0,b.uX)(),(0,b.CE)("div",Tn,(0,k.v_)(e.status),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",Qn,[(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t=>e.priority=t,required:""},Jn,8,On),[[s.u1,e.priority]])])):((0,b.uX)(),(0,b.CE)("div",Rn,(0,k.v_)(e.priority),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",Bn,[(0,b.bo)((0,b.Lk)("textarea",{type:"text","onUpdate:modelValue":t=>e.rca=t,class:"form-control custom-textarea",required:""},null,8,Kn),[[s.Jo,e.rca]])])):((0,b.uX)(),(0,b.CE)("div",Hn,(0,k.v_)(e.rca),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",Wn,[(0,b.bo)((0,b.Lk)("textarea",{type:"text","onUpdate:modelValue":t=>e.notes=t,class:"form-control custom-textarea"},null,8,Yn),[[s.Jo,e.notes]])])):((0,b.uX)(),(0,b.CE)("div",zn,(0,k.v_)(e.notes),1))])])))),128))])])])):(0,b.Q3)("",!0),e.currentPage.records&&e.currentPage.records.changes.length>0?((0,b.uX)(),(0,b.CE)("div",Gn,[Zn,(0,b.Lk)("table",el,[tl,(0,b.Lk)("tbody",null,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.currentPage.records.changes,(e=>((0,b.uX)(),(0,b.CE)("tr",{key:e.chgNumber,required:""},[(0,b.Lk)("td",null,(0,k.v_)(e.chgNumber),1),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",sl,[(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t=>e.status=t,required:""},ll,8,ol),[[s.u1,e.status]])])):((0,b.uX)(),(0,b.CE)("div",al,(0,k.v_)(e.status),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",rl,[(0,b.bo)((0,b.Lk)("input",{type:"datetime-local",class:"form-control",id:"startDate","onUpdate:modelValue":t=>e.startDate=t,required:""},null,8,dl),[[s.Jo,e.startDate]])])):((0,b.uX)(),(0,b.CE)("div",il,(0,k.v_)(e.startDate),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",ul,[(0,b.bo)((0,b.Lk)("input",{type:"datetime-local",class:"form-control",id:"endDate","onUpdate:modelValue":t=>e.endDate=t,required:""},null,8,ml),[[s.Jo,e.endDate]])])):((0,b.uX)(),(0,b.CE)("div",cl,(0,k.v_)(e.endDate),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",hl,[(0,b.bo)((0,b.Lk)("textarea",{type:"text","onUpdate:modelValue":t=>e.notes=t,class:"form-control custom-textarea"},null,8,gl),[[s.Jo,e.notes]])])):((0,b.uX)(),(0,b.CE)("div",pl,(0,k.v_)(e.notes),1))])])))),128))])])])):(0,b.Q3)("",!0),e.currentPage.records&&e.currentPage.records.serviceRequests.length>0?((0,b.uX)(),(0,b.CE)("div",bl,[kl,(0,b.Lk)("table",vl,[fl,(0,b.Lk)("tbody",null,[((0,b.uX)(!0),(0,b.CE)(b.FK,null,(0,b.pI)(e.currentPage.records.serviceRequests,(e=>((0,b.uX)(),(0,b.CE)("tr",{key:e.ritmNumber,required:""},[(0,b.Lk)("td",null,(0,k.v_)(e.ritmNumber),1),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",yl,[(0,b.bo)((0,b.Lk)("select",{"onUpdate:modelValue":t=>e.status=t,required:""},Cl,8,Pl),[[s.u1,e.status]])])):((0,b.uX)(),(0,b.CE)("div",Ll,(0,k.v_)(e.status),1))]),(0,b.Lk)("td",Sl,[n.editMode?((0,b.uX)(),(0,b.CE)("div",Il,[(0,b.bo)((0,b.Lk)("textarea",{type:"text","onUpdate:modelValue":t=>e.short_description=t,class:"form-control custom-textarea",required:""},null,8,Nl),[[s.Jo,e.short_description]])])):((0,b.uX)(),(0,b.CE)("div",El,(0,k.v_)(e.short_description),1))]),(0,b.Lk)("td",null,[n.editMode?((0,b.uX)(),(0,b.CE)("div",Tl,[(0,b.bo)((0,b.Lk)("textarea",{type:"text","onUpdate:modelValue":t=>e.notes=t,class:"form-control custom-textarea"},null,8,Dl),[[s.Jo,e.notes]])])):((0,b.uX)(),(0,b.CE)("div",ql,(0,k.v_)(e.notes),1))])])))),128))])])])):(0,b.Q3)("",!0)])):((0,b.uX)(),(0,b.CE)("div",Al,"No data available"))])}var Ml={data(){return{editMode:!1,userProfile:{role:localStorage.getItem("roles"),name:localStorage.getItem("user")},originalPageState:null,usersOnPage:[],currentImportType:"",lastEditedBy:"",jsonData:null,selectedClient:"",newIncident:{client:"",incNumber:"",status:"Active",dateOpened:"",priority:"P4 - Low",mainProblem:"",notes:""},newProblem:{client:"",prbNumber:"",status:"Evaluate",priority:"P4 - Low",rca:"",notes:""},newChange:{client:"",chgNumber:"",status:"New",startDate:"",endDate:"",notes:""},newRequest:{client:"",ritmNumber:"",status:"Draft",short_description:"",notes:""}}},computed:{...(0,i.aH)(["clients","currentPage","pages","shifts","currentShift","toasts","usersOnPage"]),isEngineer(){return"Engineer"===this.userProfile.role},maxDate(){const e=new Date,t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0");return`${t}-${a}-${s}T${o}:${n}`},isLocked(){return this.$store.state.isPageLocked&&this.$store.state.lockedPageId===this.currentPage.id}},methods:{...(0,i.i0)(["fetchPageDetails","debouncedUpdatePageDetails","deletePage","addToast","fetchClients","fetchPages","setPages","setCurrentPage","fetchShifts","fetchShiftDetails"]),async toggleEditMode(){this.editMode?(this.hasChanges()&&await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),await this.$store.dispatch("debouncedUnlockEditMode",{pageId:this.currentPage.id,pageTitle:this.currentPage.title,userName:this.userProfile.name})):this.isLocked||await this.$store.dispatch("debouncedLockEditMode",{pageId:this.currentPage.id,pageTitle:this.currentPage.title,userName:this.userProfile.name}),this.editMode=!this.editMode},hasChanges(){return JSON.stringify(this.currentPage)!==this.originalPageState},async updateEngineersOnShift(){if(this.selectedShiftId){const e=this.shifts.find((e=>e.id===this.selectedShiftId));e&&(this.currentPage.engineersOnShift=e.engineers)}},handleFileUpload(e){const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{try{this.jsonData=JSON.parse(e.target.result)}catch(t){console.error("Invalid JSON format:",t),this.addToast({message:"Invalid JSON file format",type:"danger"})}},e.readAsText(t)}},async saveIncident(){this.currentPage.records||(this.currentPage.records={}),this.currentPage.records.incidents||(this.currentPage.records.incidents=[]);const e={client:this.newIncident.client,incNumber:this.newIncident.incNumber,status:this.newIncident.status,dateOpened:this.newIncident.dateOpened,priority:this.newIncident.priority,mainProblem:this.newIncident.mainProblem,notes:this.newIncident.notes};this.currentPage.records.incidents.push(e);try{await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.resetNewIncident(),this.$router.push({name:"HomePage"})}catch(t){console.error("Error saving incident:",t),this.addToast({message:"Error saving incident:",type:"danger"})}},resetNewIncident(){this.newIncident={client:"",incNumber:"",status:"Active",dateOpened:"",priority:"P4 - Low",mainProblem:"",notes:""}},recordExists(e,t,a){return e.some((e=>e[t]===a))},getPriorityLabel(e){switch(parseInt(e)){case 4:return"P4 - Low";case 3:return"P3 - moderate";case 2:return"P2 - high";case 1:return"P1 - Critical";default:return""}},mapIncidentState(e){switch(parseInt(e)){case 8:return"Cancelled";case 7:return"Closed";case 6:return"Resolved";case 5:return"Awaiting Third Party";case 4:return"Awaiting User Info";case 2:return"Active";case 1:return"New";default:return""}},async importIncidentRecords(){if(this.jsonData)if(this.selectedClient)try{console.log("Importing incidents:",this.jsonData),this.jsonData.records.forEach((e=>{const t={client:this.selectedClient,incNumber:e.number||"",status:this.mapIncidentState(e.incident_state),dateOpened:e.opened_at||"",priority:this.getPriorityLabel(e.priority),mainProblem:e.short_description||"No description",notes:"Test note"},a=this.currentPage.records.incidents.find((e=>e.incNumber===t.incNumber));a?Object.assign(a,t):this.currentPage.records.incidents.push(t)})),await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.addToast({message:"Incidents imported successfully",type:"success"}),this.jsonData=null,this.clientName="",this.currentImportType=""}catch(e){console.error("Error importing incidents:",e),this.addToast({message:"Error importing incidents",type:"danger"})}else this.addToast({message:"Client selection is required",type:"danger"});else this.addToast({message:"No file uploaded",type:"danger"})},async importProblemRecords(){if(this.jsonData)if(this.selectedClient)try{console.log("Importing problems:",this.jsonData),this.jsonData.records.forEach((e=>{const t={client:this.selectedClient,prbNumber:e.number||"",status:"Evaluate",priority:this.getPriorityLabel(e.priority),rca:e.short_description||"",notes:"Test note"},a=this.currentPage.records.problems.find((e=>e.prbNumber===t.prbNumber));a?Object.assign(a,t):this.currentPage.records.problems.push(t)})),await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.addToast({message:"Problems imported successfully",type:"success"}),this.jsonData=null,this.clientName="",this.currentImportType=""}catch(e){console.error("Error importing problems:",e),this.addToast({message:"Error importing problems",type:"danger"})}else this.addToast({message:"Client selection is required",type:"danger"});else this.addToast({message:"No file uploaded",type:"danger"})},async importChangeRecords(){if(this.jsonData)if(this.selectedClient)try{console.log("Importing changes:",this.jsonData),this.jsonData.records.forEach((e=>{const t={client:this.selectedClient,chgNumber:e.number||"",status:"Authorize",startDate:e.start_date||"",endDate:e.end_date||"",notes:e.short_description||""},a=this.currentPage.records.changes.find((e=>e.chgNumber===t.chgNumber));a?Object.assign(a,t):this.currentPage.records.changes.push(t)})),await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.addToast({message:"Changes imported successfully",type:"success"}),this.jsonData=null,this.clientName="",this.currentImportType=""}catch(e){console.error("Error importing changes:",e),this.addToast({message:"Error importing changes",type:"danger"})}else this.addToast({message:"Client selection is required",type:"danger"});else this.addToast({message:"No file uploaded",type:"danger"})},async importRequestRecords(){if(this.jsonData)if(this.selectedClient)try{console.log("Importing service requests:",this.jsonData),this.jsonData.records.forEach((e=>{const t={client:this.selectedClient,ritmNumber:e.number||"",status:"Draft",short_description:e.short_description||"",notes:""},a=this.currentPage.records.serviceRequests.find((e=>e.ritmNumber===t.ritmNumber));a?Object.assign(a,t):this.currentPage.records.serviceRequests.push(t)})),await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.addToast({message:"Service requests imported successfully",type:"success"}),this.jsonData=null,this.clientName="",this.currentImportType=""}catch(e){console.error("Error importing service requests:",e),this.addToast({message:"Error importing service requests",type:"danger"})}else this.addToast({message:"Client selection is required",type:"danger"});else this.addToast({message:"No file uploaded",type:"danger"})},async saveProblem(){const e={client:this.newProblem.client,prbNumber:this.newProblem.prbNumber,status:this.newProblem.status,priority:this.newProblem.priority,rca:this.newProblem.rca,notes:this.newProblem.notes};this.currentPage.records.problems.push(e);try{await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.resetNewProblem(),this.$router.push({name:"HomePage"})}catch(t){console.error("Error saving problem:",t),this.addToast({message:"Error saving problem:",type:"danger"})}},resetNewProblem(){this.newProblem={client:"",prbNumber:"",status:"Active",priority:"P4 - Low",rca:"",notes:""}},async saveChange(){const e={client:this.newChange.client,chgNumber:this.newChange.chgNumber,status:this.newChange.status,startDate:this.newChange.startDate,endDate:this.newChange.endDate,notes:this.newChange.notes};this.currentPage.records.changes.push(e);try{await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.resetNewChange()}catch(t){console.error("Error saving change:",t),this.addToast({message:"Error saving change:",type:"danger"})}},resetNewChange(){this.newChange={client:"",chgNumber:"",status:"Active",startDate:"",endDate:"",notes:""}},async saveRequest(){const e={client:this.newRequest.client,ritmNumber:this.newRequest.ritmNumber,status:this.newRequest.status,short_description:this.newRequest.short_description,notes:this.newRequest.notes};this.currentPage.records.serviceRequests.push(e);try{await this.debouncedUpdatePageDetails({page:this.currentPage,source:this.$socket.id}),this.resetNewRequest()}catch(t){console.error("Error saving service request:",t),this.addToast({message:"Error saving service request:",type:"danger"})}},resetNewRequest(){this.newRequest={client:"",ritmNumber:"",status:"Draft",short_description:"",notes:""}},async removePage(){const e=this.currentPage.id,t=this.currentPage.title;if(console.log("Removing page:",e),!e)return console.error("Page ID is undefined."),void this.addToast({message:"Failed to delete page: Page ID is undefined.",type:"danger"});const a=this.usersOnPage.filter((e=>e.socketId!==this.$socket.id));if(console.log("Other users on page:",this.usersOnPage),confirm(`Are you sure you want to delete "${t}"? This action cannot be undone.`)){if(a.length>0){const e=a.map((e=>e.username||"another user")).join(", "),t=`Other users (${e}) are also viewing this page. Are you sure you want to delete it?`;if(!confirm(t))return}try{const a=await fetch(`/api/records/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to delete page");this.$socket.emit("deletePage",{id:e,title:t,pageId:e}),this.$router.push({name:"HomePage"})}catch(s){this.addToast({message:`Failed to delete page: ${s.message}`,type:"danger"})}}},handlePageUpdated(e){console.log("Page updated event received:",e),this.currentPage&&this.currentPage.id===e.id&&(this.currentPage.version!==e.version?(console.log("Version conflict detected."),confirm("This page has been updated by another user. Would you like to reload the latest version?")?this.fetchPageDetails(e.id):this.addToast({message:"You are viewing an outdated version of the page.",type:"warning"})):(this.setCurrentPage(e),console.log("Current page updated without conflict.")))}},created(){const e=this.$route.params.id;this.fetchShifts(),this.fetchClients();const t=localStorage.getItem("userName");console.log("DOC ID",e),e?(this.fetchPageDetails(e),this.$socket.emit("viewPage",{pageId:e,userName:t})):console.error("Page ID is undefined."),this.$socket.on("usersOnPage",(e=>{console.log("Users on page:",e),this.$store.commit("setUsersOnPage",e)})),this.$socket.on("connect",(()=>{this.socketId=this.$socket.id}))},beforeUnmount(){this.$socket.off("usersOnPage"),this.$socket.off("pageDeleted"),this.$socket.emit("leavePage",{pageId:this.currentPage.id})}};const _l=(0,E.A)(Ml,[["render",Ul],["__scopeId","data-v-e95e601c"]]);var $l=_l,xl={components:{NavBarComponent:Et,SideBarComponent:Rt,shiftComp:$l}};const Rl=(0,E.A)(xl,[["render",Q]]);var Ql=Rl;const Ol=(0,q.aE)({history:(0,q.LA)("/"),routes:[{path:"/login",name:"Login",component:M},{path:"/",name:"Home",component:Ql,meta:{requiresAuth:!0}}]});Ol.beforeEach(((e,t,a)=>{const s="true"===localStorage.getItem("userAuthenticated");e.matched.some((e=>e.meta.requiresAuth))&&!s?a("/login"):"/login"===e.path&&s?a("/"):a()}));var Xl=Ol;const Vl=(0,s.Ef)(N);Vl.config.globalProperties.$socket=u,Vl.use(Xl),Vl.use(l()),Vl.use(g),u.on("connect",(()=>{console.log("Connected to Socket.IO server")})),u.on("disconnect",(()=>{console.log("Disconnected from Socket.IO server")})),o.A.get("/auth/status").then((e=>{console.log("Authentication status:",e.data.authenticated),console.log("User:",e.data.user.name),e.data.authenticated?(localStorage.setItem("userAuthenticated","true"),localStorage.setItem("user",e.data.user.name),localStorage.setItem("roles",e.data.user.roles),Vl.mount("#app")):(localStorage.removeItem("userAuthenticated"),localStorage.removeItem("user"),console.log(localStorage.getItem("user")),Xl.push("/login"),Vl.mount("#app"))})).catch((e=>{console.error("Error checking authentication status:",e),localStorage.removeItem("userAuthenticated"),localStorage.removeItem("user"),Xl.push("/login"),Vl.mount("#app")}))}},t={};function a(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=e,function(){var e=[];a.O=function(t,s,o,n){if(!s){var l=1/0;for(c=0;c<e.length;c++){s=e[c][0],o=e[c][1],n=e[c][2];for(var i=!0,r=0;r<s.length;r++)(!1&n||l>=n)&&Object.keys(a.O).every((function(e){return a.O[e](s[r])}))?s.splice(r--,1):(i=!1,n<l&&(l=n));if(i){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,o,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,n,l=s[0],i=s[1],r=s[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(r)var c=r(a)}for(t&&t(s);d<l.length;d++)n=l[d],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},s=self["webpackChunkclient"]=self["webpackChunkclient"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(5455)}));s=a.O(s)})();
//# sourceMappingURL=app.dbcf70d4.js.map